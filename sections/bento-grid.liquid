{{ 'section-bento-grid.css' | asset_url | stylesheet_tag }}

{%- liquid
  assign scheme = section.settings.color_scheme
  if scheme == blank
    assign scheme = settings.color_schemes | first
  endif
-%}

<div
  class="section-bento-grid color-{{ scheme.id }}"
  style="background-color: {{ scheme.settings.background }}; color: {{ scheme.settings.text }};"
>
  <div class="bento-grid-wrapper page-width">
    <div class="bento-grid" style="gap: {{ section.settings.grid_gap }}px;">
      {%- for block in section.blocks -%}
        <div
          class="bento-item bento-item--{{ block.type }} bento-col-span-{{ block.settings.column_span }} bento-row-span-{{ block.settings.row_span }} bento-shape-{{ block.settings.card_shape }}"
          {{ block.shopify_attributes }}
        >
          {%- case block.type -%}
            {%- when 'card' -%}
              <div class="bento-item__image-container">
                {%- if block.settings.image != blank -%}
                  {{
                    block.settings.image
                    | image_url: width: 800
                    | image_tag: class: 'bento-item__image', widths: '300, 600, 800', loading: 'lazy'
                  }}
                {%- elsif block.settings.external_image_url != blank -%}
                  <img
                    src="{{ block.settings.external_image_url }}"
                    class="bento-item__image"
                    alt="{{ block.settings.heading | escape }}"
                    loading="lazy"
                    width="800"
                    height="600"
                  >
                {%- else -%}
                  {{ 'image' | placeholder_svg_tag: 'bento-item__image placeholder-svg' }}
                {%- endif -%}
              </div>
              <div class="bento-item__content">
                {%- if block.settings.heading != blank -%}
                  <h3 class="bento-item__heading">{{ block.settings.heading }}</h3>
                {%- endif -%}
              </div>

            {%- when 'text_card' -%}
              <div class="bento-item__text-container bento-custom-scrollbar">
                {%- if block.settings.heading != blank -%}
                  <h3 class="bento-item__heading bento-item__heading--static">{{ block.settings.heading }}</h3>
                {%- endif -%}
                <div class="bento-item__text-content rtl-enabled">
                  {{ block.settings.text }}
                </div>
              </div>

            {%- when 'tag_card' -%}
              <div class="bento-item__tag-layout bento-item__tag-layout--{{ block.settings.layout_direction }} bento-item__tag-layout--align-{{ block.settings.content_alignment }} bento-item__tag-layout--justify-{{ block.settings.content_justification }}">
                {%- if block.settings.tag_text != blank -%}
                  <span class="bento-item__tag-pill">{{ block.settings.tag_text }}</span>
                {%- endif -%}
                {%- if block.settings.heading != blank -%}
                  <h3 class="bento-item__heading bento-item__heading--static">{{ block.settings.heading }}</h3>
                {%- endif -%}
                <div class="bento-item__image-container bento-item__image-container--relative">
                  {%- if block.settings.image != blank -%}
                    {{
                      block.settings.image
                      | image_url: width: 600
                      | image_tag: class: 'bento-item__image', loading: 'lazy'
                    }}
                  {%- else -%}
                    {{ 'image' | placeholder_svg_tag: 'bento-item__image placeholder-svg' }}
                  {%- endif -%}
                </div>
              </div>

            {%- when 'video_card' -%}
              <div class="bento-item__video-container">
                {%- if block.settings.video != blank -%}
                  {{
                    block.settings.video
                    | video_tag: autoplay: true, loop: true, muted: true, controls: false, class: 'bento-item__video'
                  }}
                {%- elsif block.settings.video_url != blank -%}
                  {%- if block.settings.video_url.type == 'youtube' -%}
                    <iframe
                      src="https://www.youtube.com/embed/{{ block.settings.video_url.id }}?autoplay=1&mute=1&loop=1&playlist={{ block.settings.video_url.id }}"
                      frameborder="0"
                      allow="autoplay; encrypted-media"
                      allowfullscreen
                      class="bento-item__video"
                    ></iframe>
                  {%- else -%}
                    <iframe
                      src="https://player.vimeo.com/video/{{ block.settings.video_url.id }}?autoplay=1&muted=1&loop=1"
                      frameborder="0"
                      allow="autoplay; fullscreen"
                      allowfullscreen
                      class="bento-item__video"
                    ></iframe>
                  {%- endif -%}
                {%- endif -%}
              </div>
              <div class="bento-item__content">
                {%- if block.settings.heading != blank -%}
                  <h3 class="bento-item__heading">{{ block.settings.heading }}</h3>
                {%- endif -%}
              </div>

            {%- when 'blog_card' -%}
              {%- assign article = block.settings.article -%}
              <div class="bento-item__image-container">
                {%- if article.image != blank -%}
                  {{ article.image | image_url: width: 800 | image_tag: class: 'bento-item__image', loading: 'lazy' }}
                {%- else -%}
                  {{ 'image' | placeholder_svg_tag: 'bento-item__image placeholder-svg' }}
                {%- endif -%}
              </div>
              <div class="bento-item__content">
                <span class="bento-item__label">Blog</span>
                <h3 class="bento-item__heading">{{ article.title | default: 'Post Title' }}</h3>
              </div>

            {%- when 'product_card' -%}
              {%- assign product = block.settings.product -%}
              <div class="bento-item__image-container">
                {%- if product.featured_image != blank -%}
                  {{
                    product.featured_image
                    | image_url: width: 800
                    | image_tag: class: 'bento-item__image', loading: 'lazy'
                  }}
                {%- else -%}
                  {{ 'product-1' | placeholder_svg_tag: 'bento-item__image placeholder-svg' }}
                {%- endif -%}
              </div>
              <div class="bento-item__content">
                <span class="bento-item__label">{{ product.price | money }}</span>
                <h3 class="bento-item__heading">{{ product.title | default: 'Product Name' }}</h3>
              </div>
          {%- endcase -%}

          {%- assign card_link = block.settings.link -%}
          {%- if block.type == 'blog_card' -%}{%- assign card_link = block.settings.article.url -%}{%- endif -%}
          {%- if block.type == 'product_card' -%}{%- assign card_link = block.settings.product.url -%}{%- endif -%}

          {%- if card_link != blank -%}
            <a
              href="{{ card_link }}"
              style="position:absolute; top:0; left:0; width:100%; height:100%; z-index: 4;"
              aria-label="{{ block.settings.heading | default: 'Link' }}"
            ></a>
          {%- endif -%}
        </div>
      {%- endfor -%}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Bento Grid",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color Scheme",
      "default": "scheme-1"
    },
    {
      "type": "range",
      "id": "grid_gap",
      "min": 0,
      "max": 60,
      "step": 2,
      "unit": "px",
      "label": "Grid Gap",
      "default": 16
    }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Image Card",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "external_image_url",
          "label": "External Image URL"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Card Title"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        },
        {
          "type": "select",
          "id": "card_shape",
          "label": "Card Shape",
          "options": [
            { "value": "rectangle", "label": "Rectangle" },
            { "value": "l_cut_bottom_right", "label": "L-Shape (Cut Bottom Right)" },
            { "value": "l_cut_bottom_left", "label": "L-Shape (Cut Bottom Left)" },
            { "value": "l_cut_top_right", "label": "L-Shape (Cut Top Right)" },
            { "value": "l_cut_top_left", "label": "L-Shape (Cut Top Left)" }
          ],
          "default": "rectangle"
        },
        {
          "type": "select",
          "id": "column_span",
          "label": "Column Span (1-10)",
          "options": [
            { "value": "1", "label": "1/10" },
            { "value": "2", "label": "2/10" },
            { "value": "3", "label": "3/10" },
            { "value": "4", "label": "4/10" },
            { "value": "5", "label": "5/10" },
            { "value": "6", "label": "6/10" },
            { "value": "7", "label": "7/10" },
            { "value": "8", "label": "8/10" },
            { "value": "9", "label": "9/10" },
            { "value": "10", "label": "10/10" }
          ],
          "default": "2"
        },
        {
          "type": "select",
          "id": "row_span",
          "label": "Row Span (1-10)",
          "options": [
            { "value": "1", "label": "1 Unit" },
            { "value": "2", "label": "2 Units" },
            { "value": "3", "label": "3 Units" },
            { "value": "4", "label": "4 Units" },
            { "value": "5", "label": "5 Units" },
            { "value": "6", "label": "6 Units" },
            { "value": "7", "label": "7 Units" },
            { "value": "8", "label": "8 Units" },
            { "value": "9", "label": "9 Units" },
            { "value": "10", "label": "10 Units" }
          ],
          "default": "2"
        }
      ]
    },
    {
      "type": "text_card",
      "name": "Text Card",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Heading"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Content",
          "default": "<p>Add your text here. If it exceeds the card height, it will be scrollable.</p>"
        },
        {
          "type": "select",
          "id": "card_shape",
          "label": "Card Shape",
          "options": [
            { "value": "rectangle", "label": "Rectangle" },
            { "value": "l_cut_bottom_right", "label": "L-Shape (Cut Bottom Right)" },
            { "value": "l_cut_bottom_left", "label": "L-Shape (Cut Bottom Left)" },
            { "value": "l_cut_top_right", "label": "L-Shape (Cut Top Right)" },
            { "value": "l_cut_top_left", "label": "L-Shape (Cut Top Left)" }
          ],
          "default": "rectangle"
        },
        {
          "type": "select",
          "id": "column_span",
          "label": "Column Span",
          "options": [
            { "value": "1", "label": "1/10" },
            { "value": "2", "label": "2/10" },
            { "value": "3", "label": "3/10" },
            { "value": "4", "label": "4/10" },
            { "value": "5", "label": "5/10" },
            { "value": "6", "label": "6/10" },
            { "value": "7", "label": "7/10" },
            { "value": "8", "label": "8/10" },
            { "value": "9", "label": "9/10" },
            { "value": "10", "label": "10/10" }
          ],
          "default": "3"
        },
        {
          "type": "select",
          "id": "row_span",
          "label": "Row Span",
          "options": [
            { "value": "1", "label": "1" },
            { "value": "2", "label": "2" },
            { "value": "3", "label": "3" },
            { "value": "4", "label": "4" },
            { "value": "5", "label": "5" }
          ],
          "default": "2"
        }
      ]
    },
    {
      "type": "tag_card",
      "name": "Tag Card",
      "settings": [
        {
          "type": "text",
          "id": "tag_text",
          "label": "Tag Text",
          "default": "New"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Tag Card Heading"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "select",
          "id": "layout_direction",
          "label": "Layout Direction",
          "options": [
            { "value": "row", "label": "Row" },
            { "value": "row-reverse", "label": "Row Reverse" },
            { "value": "column", "label": "Column" },
            { "value": "column-reverse", "label": "Column Reverse" }
          ],
          "default": "row"
        },
        {
          "type": "select",
          "id": "content_alignment",
          "label": "Content Alignment (Cross Axis)",
          "options": [
            { "value": "start", "label": "Start" },
            { "value": "center", "label": "Center" },
            { "value": "end", "label": "End" }
          ],
          "default": "center"
        },
        {
          "type": "select",
          "id": "content_justification",
          "label": "Content Justification (Main Axis)",
          "options": [
            { "value": "start", "label": "Start" },
            { "value": "center", "label": "Center" },
            { "value": "end", "label": "End" },
            { "value": "between", "label": "Space Between" }
          ],
          "default": "center"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        },
        {
          "type": "select",
          "id": "column_span",
          "label": "Column Span",
          "options": [
            { "value": "1", "label": "1/10" },
            { "value": "2", "label": "2/10" },
            { "value": "3", "label": "3/10" },
            { "value": "4", "label": "4/10" },
            { "value": "5", "label": "5/10" },
            { "value": "6", "label": "6/10" },
            { "value": "7", "label": "7/10" },
            { "value": "8", "label": "8/10" },
            { "value": "9", "label": "9/10" },
            { "value": "10", "label": "10/10" }
          ],
          "default": "4"
        },
        {
          "type": "select",
          "id": "row_span",
          "label": "Row Span",
          "options": [
            { "value": "1", "label": "1" },
            { "value": "2", "label": "2" },
            { "value": "3", "label": "3" },
            { "value": "4", "label": "4" },
            { "value": "5", "label": "5" }
          ],
          "default": "2"
        }
      ]
    },
    {
      "type": "video_card",
      "name": "Video Card",
      "settings": [
        {
          "type": "video",
          "id": "video",
          "label": "Shopify Video"
        },
        {
          "type": "video_url",
          "id": "video_url",
          "label": "External Video URL",
          "accept": ["youtube", "vimeo"]
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading Over Video"
        },
        {
          "type": "select",
          "id": "column_span",
          "label": "Column Span",
          "options": [
            { "value": "1", "label": "1/10" },
            { "value": "2", "label": "2/10" },
            { "value": "3", "label": "3/10" },
            { "value": "4", "label": "4/10" },
            { "value": "5", "label": "5/10" },
            { "value": "6", "label": "6/10" },
            { "value": "7", "label": "7/10" },
            { "value": "8", "label": "8/10" },
            { "value": "9", "label": "9/10" },
            { "value": "10", "label": "10/10" }
          ],
          "default": "4"
        },
        {
          "type": "select",
          "id": "row_span",
          "label": "Row Span",
          "options": [
            { "value": "1", "label": "1" },
            { "value": "2", "label": "2" },
            { "value": "3", "label": "3" },
            { "value": "4", "label": "4" },
            { "value": "5", "label": "5" }
          ],
          "default": "3"
        }
      ]
    },
    {
      "type": "blog_card",
      "name": "Blog Card",
      "settings": [
        {
          "type": "article",
          "id": "article",
          "label": "Article"
        },
        {
          "type": "select",
          "id": "column_span",
          "label": "Column Span",
          "options": [
            { "value": "1", "label": "1/10" },
            { "value": "2", "label": "2/10" },
            { "value": "3", "label": "3/10" },
            { "value": "4", "label": "4/10" },
            { "value": "5", "label": "5/10" },
            { "value": "6", "label": "6/10" },
            { "value": "7", "label": "7/10" },
            { "value": "8", "label": "8/10" },
            { "value": "9", "label": "9/10" },
            { "value": "10", "label": "10/10" }
          ],
          "default": "3"
        },
        {
          "type": "select",
          "id": "row_span",
          "label": "Row Span",
          "options": [
            { "value": "1", "label": "1" },
            { "value": "2", "label": "2" },
            { "value": "3", "label": "3" },
            { "value": "4", "label": "4" },
            { "value": "5", "label": "5" }
          ],
          "default": "2"
        }
      ]
    },
    {
      "type": "product_card",
      "name": "Product Card",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Product"
        },
        {
          "type": "select",
          "id": "column_span",
          "label": "Column Span",
          "options": [
            { "value": "1", "label": "1/10" },
            { "value": "2", "label": "2/10" },
            { "value": "3", "label": "3/10" },
            { "value": "4", "label": "4/10" },
            { "value": "5", "label": "5/10" },
            { "value": "6", "label": "6/10" },
            { "value": "7", "label": "7/10" },
            { "value": "8", "label": "8/10" },
            { "value": "9", "label": "9/10" },
            { "value": "10", "label": "10/10" }
          ],
          "default": "2"
        },
        {
          "type": "select",
          "id": "row_span",
          "label": "Row Span",
          "options": [
            { "value": "1", "label": "1" },
            { "value": "2", "label": "2" },
            { "value": "3", "label": "3" },
            { "value": "4", "label": "4" },
            { "value": "5", "label": "5" }
          ],
          "default": "2"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Bento Grid"
    }
  ]
}
{% endschema %}
